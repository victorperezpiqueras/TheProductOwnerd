<mat-card class="mat-elevation-z3" fxLayout="column" fxLayoutAlign="start start">
  <div fxFill fxLayoutAlign="center center">
    <mat-card-title>
      <h1 class="mat-h1" style="text-align: center;">Backlog Proposal</h1>
    </mat-card-title>
  </div>

  <mat-card-content fxFlex="100" fxLayoutAlign="start start" fxLayout="column" fxFill>
    <div
      class="droplist"
      cdkDropList
      [cdkDropListData]="backlog"
      (cdkDropListDropped)="drop($event)"
      [cdkDropListDisabled]="permisos?.ordenar == 0"
      fxLayout="column"
      fxFill
      fxLayoutGap="1%"
    >
      <ng-container *ngFor="let pbi of backlog">
        <mat-card
          *ngIf="pbi.done == 0"
          class="card mat-elevation-z9"
          cdkDrag
          (cdkDragStarted)="isDragging = true"
          (cdkDragReleased)="isDragging = false"
          (click)="verPbiDialog(pbi)"
          [ngStyle]="{ 'background-color': getPbiIncluded(pbi) ? '#cbffbc' : '#f5f5f5' }"
        >
          <mat-card-header>
            <mat-card-title>
              <mat-icon
                class="drag-icon"
                *ngIf="!(permisos?.ordenar == 0)"
                cdkDragHandle
                matTooltip="Drag to change prioritization"
                matTooltipPosition="above"
                matTooltipShowDelay="500"
                [matTooltipDisabled]="isDragging"
                >open_with</mat-icon
              >
              #{{ pbi.idpbi }} - {{ pbi.titulo }}
            </mat-card-title>
            <div fxLayout="row" fxLayoutGap="10px" style="float:right;margin-left:auto; margin-right:0;">
              <mat-chip-list>
                <mat-chip
                  [ngStyle]="{ 'background-color': getLabelColor(pbi.label) }"
                  color="accent"
                  selected
                  style="white-space:nowrap;"
                >
                  {{ pbi.label }}
                </mat-chip>
              </mat-chip-list>
              <button
                *ngIf="pbi.estimacion != null"
                class="estimacion"
                mat-mini-fab
                color="accent"
                [disableRipple]="true"
              >
                {{ pbi.estimacion }}
              </button>
              <b *ngIf="permisos?.ordenar == 0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>
            </div>
          </mat-card-header>
          <mat-card-content>
            <p *ngIf="pbi.descripcion" style="color: rgb(119, 119, 119);font-size: 1.5vmin;margin-left:2%;">
              {{ pbi.descripcion | limitTo: 50 }}
            </p>
          </mat-card-content>
        </mat-card>
        <br />
      </ng-container>
    </div>
  </mat-card-content>
</mat-card>
